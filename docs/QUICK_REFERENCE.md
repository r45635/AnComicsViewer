# AnComicsViewer - Quick Reference

## 🚀 Quick Start

```bash
# 1. One-command setup
./setup.sh

# 2. Start application
source .venv/bin/activate
python AnComicsViewer.py
```

## 📱 Application Controls

| Action | Shortcut | Button |
|--------|----------|--------|
| Open PDF | `Ctrl+O` | 📂 |
| Toggle panels | `Ctrl+2` | ▦ |
| Next panel | `N` | ▶ |
| Previous panel | `Shift+N` | ◀ |
| Zoom in | `Ctrl++` | 🔍+ |
| Zoom out | `Ctrl+-` | 🔍- |
| Fit width | `Ctrl+1` | 📏 |
| Fit page | `Ctrl+0` | 🗎 |

## ⚙️ Settings Menu

| Feature | Path |
|---------|------|
| Debug logs | ⚙️ → Debug logs |
| Presets | ⚙️ → Presets → Franco-Belge/Manga/Newspaper |
| Detection DPI | ⚙️ → Detection DPI: 150/200 |
| Detector switch | ⚙️ → Detector → Heuristic/YOLOv8 |
| Load ML weights | ⚙️ → Detector → Load ML weights... |
| Advanced tuning | ⚙️ → Advanced tuning... |

## 🤖 ML Detector

```bash
# 1. Load weights in app: ⚙️ → Detector → Load ML weights...
# 2. Switch to ML: ⚙️ → Detector → YOLOv8 Seg (ML)
# 3. Test detection with panel overlay (Ctrl+2)
```

## 📊 Dataset Creation

```bash
# Extract PDF pages
python tools/export_pdf_pages.py "comic.pdf" --out dataset/images/train --dpi 300

# Create train/val split (auto-generated by setup)
# Results in ~90% train, ~10% validation

# Start annotation
python start_annotation.py

# Convert annotations to YOLO
python post_annotation_processing.py
```

## 🎯 Training

```bash
# Train YOLOv8 model
yolo segment train model=yolov8n-seg.pt data=ml/dataset.yaml imgsz=1280

# Use trained model in app
# ⚙️ → Detector → Load ML weights... → select your trained .pt file
```

## 🛠 VS Code Tasks

| Task | Command |
|------|---------|
| Run App | `Ctrl+Shift+P` → Tasks: Run Task → Run App |
| Debug | `F5` (Run ComicsView) |
| Extract Pages | `Ctrl+Shift+P` → Tasks: Run Task → Export Pages |
| Train YOLO | `Ctrl+Shift+P` → Tasks: Run Task → YOLO Train |

## 🐛 Troubleshooting

| Issue | Solution |
|-------|----------|
| Qt plugin errors (macOS) | `export QT_MAC_WANTS_LAYER=1` |
| PDF won't load | `chmod 644 "file.pdf"` |
| ML model won't load | Already fixed in code (PyTorch compatibility) |
| Slow detection | Lower DPI (150), use presets |

## 📁 Key Files

| File | Purpose |
|------|---------|
| `AnComicsViewer.py` | Main application |
| `README_SETUP.md` | Complete setup guide |
| `setup.sh` | Automated setup script |
| `start_annotation.py` | Launch annotation tool |
| `post_annotation_processing.py` | Convert annotations |
| `.vscode/tasks.json` | VS Code build tasks |
| `ml/dataset.yaml` | YOLO training config |

## 💡 Tips

- **Franco-Belge preset**: Best for traditional European comics
- **Manga preset**: Optimized for Japanese comics (RTL)
- **Detection DPI 200**: Higher quality, slower
- **Detection DPI 150**: Faster, good quality
- **Panel navigation**: Use N/Shift+N for efficient reading
- **Advanced tuning**: Real-time parameter adjustment

## 🎨 Comic Formats Tested

| Format | Preset | Notes |
|--------|--------|-------|
| Franco-Belgian BD | Franco-Belge | Golden City, Tintin, etc. |
| Manga | Manga | Right-to-left reading |
| American Comics | Franco-Belge | Usually works well |
| Newspaper Strips | Newspaper | Horizontal layouts |

---

📖 **For complete documentation**: See `README_SETUP.md`  
🔧 **For ML details**: See `ml/README-ml.md`  
🆘 **For issues**: Check troubleshooting section above
