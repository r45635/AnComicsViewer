name: ğŸ§ª Test Build System

on:
  push:
    paths:
      - 'build_*.py'
      - 'test_*.py'
      - '.github/workflows/build-executables.yml'
      - 'AnComicsViewer.py'
      - 'main.py'
  pull_request:
    paths:
      - 'build_*.py'
      - 'test_*.py'
      - '.github/workflows/build-executables.yml'
  workflow_dispatch:

jobs:
  test-build-system:
    name: ğŸ”§ Test Build Scripts
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        python-version: ['3.11']
    
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4
        
      - name: ğŸ Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}
          
      - name: ğŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          pip install pyinstaller
          
      - name: ğŸ§ª Test build workflow
        run: python test_build_workflow.py
        
      - name: ğŸ“‹ Test spec generation
        run: python build_spec.py
        
      - name: ğŸ” Test release config
        run: python release_config.py
        
      - name: ğŸ“Š Show build readiness
        run: |
          echo "## ğŸ—ï¸ Build System Status"
          echo "- OS: ${{ matrix.os }}"
          echo "- Python: ${{ matrix.python-version }}"
          echo "- PyInstaller: $(python -m PyInstaller --version)"
          echo "- Spec file: $(test -f AnComicsViewer.spec && echo 'âœ… Present' || echo 'âŒ Missing')"
          echo "- Release config: $(test -f release_config.json && echo 'âœ… Present' || echo 'âŒ Missing')"
