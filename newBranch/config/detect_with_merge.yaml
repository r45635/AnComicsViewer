# detection & post-filters
panel_conf: 0.30                      # Refined confidence threshold for panels
balloon_conf: 0.38                    # Refined confidence threshold for balloons
panel_area_min_pct: 0.03              # Minimum panel area (3% of page)
panel_area_max_pct: 0.90              # Maximum panel area (90% of page)
balloon_area_min_pct: 0.0020          # Minimum balloon area (0.20% of page)
balloon_area_max_pct: 0.30            # Maximum balloon area (30% of page)

# NMS per class
panel_nms_iou: 0.30                   # NMS IoU threshold for panels
balloon_nms_iou: 0.25                 # NMS IoU threshold for balloons

# size & margin filters
min_box_w_px: 32                      # Minimum box width in pixels
min_box_h_px: 28                      # Minimum box height in pixels
page_margin_inset_pct: 0.015          # Page margin inset percentage

# balloonâ†’panel assignment rule
balloon_min_overlap_panel: 0.06       # Minimum overlap for balloon to be attached to panel

# output quantity limits
max_panels: 12                        # Maximum number of panels to keep
max_balloons: 24                      # Maximum number of balloons to keep

# legacy compatibility
balloon_min_w: 10                     # LEGACY: for backward compatibility
balloon_min_h: 8                      # LEGACY: for backward compatibility
max_det: 600                          # Maximum detections from YOLO

# merging & post-processing
panel_merge_iou: 0.4                  # LESS AGGRESSIVE merging
panel_merge_dist: 0.05                # LESS AGGRESSIVE merging
panel_containment_merge: 0.85         # LESS AGGRESSIVE containment
enable_panel_merge: true              # ENABLED for proper panel merging
panel_row_overlap: 0.5                # LESS AGGRESSIVE row merging
panel_row_gap_pct: 0.05               # LESS AGGRESSIVE row merging
enable_row_merge: true                # ENABLED for row-based merging
iou_merge: 0.4                        # LESS AGGRESSIVE general merging

# full-page detection
full_page_panel_pct: 0.93             # threshold for detecting full-page panels
full_page_keep_balloons: true
full_page_balloon_overlap_pct: 0.12   # minimum overlap to keep balloons with full-page panels

# detection scale/tiling
imgsz_max: 4096                       # ULTRA-HIGH RESOLUTION for maximum detection
tile_target: 1536                     # INCREASED for less tiling
tile_overlap: 0.25                    # INCREASED for better coverage
force_tiling: false

# gutter splitting parameters
gutter_split_enable: false            # DISABLED for debugging
gutter_min_gap_px: 6
gutter_min_contrast: 20
gutter_min_coverage: 0.75
gutter_dir: "both"   # or "h" or "v"
